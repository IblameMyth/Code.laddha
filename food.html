<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food</title>
  <style>
    :root{
      --bg:#f8fafc;
      --card:#ffffff;
      --muted:#6b7280;
      --text:#0f172a;
      --primary:#2563eb;
      --accent:#0ea5a4;
      --radius:12px;
      --shadow:0 8px 26px rgba(15,23,42,0.06);
      --container:1100px;
      --bg-img: url('https://images.unsplash.com/photo-1542223616-1e7b2d2b02d9?auto=format&fit=crop&w=1500&q=80');
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;padding:28px;font-family:Inter, 'Segoe UI', Roboto, system-ui;background-image:linear-gradient(rgba(255,255,255,0.86),rgba(255,255,255,0.86)),var(--bg-img);background-size:cover;background-position:center;color:var(--text);
    }

    main{max-width:var(--container);margin:0 auto;min-height:68vh;padding:20px}

    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');
    header{display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--accent),var(--primary));color:#fff;padding:16px 20px;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:18px}
    header h1{margin:0;font-size:1.6rem;font-family:'Poppins',sans-serif;font-weight:600;letter-spacing:0.5px}

    form{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
    input{padding:10px;border-radius:10px;border:1px solid #e6eef8;background:#fff;min-width:150px}
    button{padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--primary),var(--accent));color:#fff;cursor:pointer}

    #summary{margin-top:12px;font-weight:700}
    canvas{display:block;margin:18px auto;max-width:640px;background:#fff;border-radius:12px;box-shadow:0 8px 24px rgba(2,6,23,0.06);padding:8px}

    footer{margin-top:36px;text-align:center;color:var(--muted)}
  </style>
    </head>
    <body>
        <header>
            <h1>ExpenseWise</h1>
        </header>
    <main>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   <h1>Food Expenses</h1>
  <div style="margin-bottom: 20px;">
    <label for="expenseMonth">Select Month: </label>
    <input type="month" id="expenseMonth" style="padding: 10px; border-radius: 10px; border: 1px solid #e6eef8;" />
  </div>
  <input type="number" id="groceries" placeholder="Groceries (₹)" />
  <input type="number" id="drinks" placeholder="Drinks (₹)" />
  <input type="number" id="dining" placeholder="Dining Out (₹)" />
  <button onclick="showChart()">Show Chart</button>
  <div id="summary"></div>
  <canvas id="foodChart"></canvas>
  
  <div style="margin-top: 20px; background: white; padding: 20px; border-radius: 12px; box-shadow: var(--shadow);">
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6eef8;">Date</th>
          <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6eef8;">Groceries</th>
          <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6eef8;">Drinks</th>
          <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6eef8;">Dining</th>
          <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6eef8;">Total</th>
        </tr>
      </thead>
      <tbody id="expenseTableBody"></tbody>
      <tfoot>
        <tr>
          <td style="padding: 12px; font-weight: bold;">Total</td>
          <td id="totalGroceries" style="padding: 12px;">₹0</td>
          <td id="totalDrinks" style="padding: 12px;">₹0</td>
          <td id="totalDining" style="padding: 12px;">₹0</td>
          <td id="grandTotal" style="padding: 12px; font-weight: bold;">₹0</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <script>
    // Set current month as default
    window.addEventListener('load', function() {
      const today = new Date();
      const month = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0');
      document.getElementById('expenseMonth').value = month;
      loadMonthlyData(month);
    });

    // Load data for selected month
    document.getElementById('expenseMonth').addEventListener('change', function() {
      loadMonthlyData(this.value);
    });

    function updateTable() {
      const tableBody = document.getElementById('expenseTableBody');
      tableBody.innerHTML = '';
      
      let totalGroceries = 0, totalDrinks = 0, totalDining = 0;
      
      // Get all food expenses from localStorage
      const expenses = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('foodExpenses_')) {
          const data = JSON.parse(localStorage.getItem(key));
          expenses.push(data);
        }
      }
      
      // Sort by date, newest first
      expenses.sort((a, b) => new Date(b.date) - new Date(a.date));
      
      // Create table rows
      expenses.forEach(expense => {
        const row = document.createElement('tr');
        const total = expense.groceries + expense.drinks + expense.dining;
        
        row.innerHTML = `
          <td style="padding: 12px; border-bottom: 1px solid #e6eef8; cursor: pointer;" onclick="loadExpense('${expense.date}')">${expense.date}</td>
          <td style="padding: 12px; border-bottom: 1px solid #e6eef8;">₹${expense.groceries}</td>
          <td style="padding: 12px; border-bottom: 1px solid #e6eef8;">₹${expense.drinks}</td>
          <td style="padding: 12px; border-bottom: 1px solid #e6eef8;">₹${expense.dining}</td>
          <td style="padding: 12px; border-bottom: 1px solid #e6eef8;">₹${total}</td>
        `;
        
        tableBody.appendChild(row);
        
        totalGroceries += expense.groceries;
        totalDrinks += expense.drinks;
        totalDining += expense.dining;
      });
      
      // Update totals
      document.getElementById('totalGroceries').textContent = `₹${totalGroceries}`;
      document.getElementById('totalDrinks').textContent = `₹${totalDrinks}`;
      document.getElementById('totalDining').textContent = `₹${totalDining}`;
      document.getElementById('grandTotal').textContent = `₹${totalGroceries + totalDrinks + totalDining}`;
    }

    function loadExpense(date) {
      document.getElementById('expenseMonth').value = date.substring(0, 7);
      const data = JSON.parse(localStorage.getItem(`foodExpenses_${date}`));
      if (data) {
        document.getElementById('groceries').value = data.groceries;
        document.getElementById('drinks').value = data.drinks;
        document.getElementById('dining').value = data.dining;
      }
    }

    function showChart() {
      const groceries = parseInt(document.getElementById('groceries').value) || 0;
      const drinks = parseInt(document.getElementById('drinks').value) || 0;
      const dining = parseInt(document.getElementById('dining').value) || 0;
      const total = groceries + drinks + dining;

      // Get the full date (YYYY-MM-DD)
      const monthKey = document.getElementById('expenseMonth').value;
      const today = new Date();
      const date = `${monthKey}-${String(today.getDate()).padStart(2, '0')}`;
      
      // Save data to localStorage with date key
      localStorage.setItem('foodExpenses_' + date, JSON.stringify({ 
        date: date,
        groceries: groceries, 
        drinks: drinks, 
        dining: dining 
      }));
      
      // Update the table
      updateTable();
      document.getElementById('summary').innerHTML = `<h3>Total Food Expenses: ₹${total}</h3>`;

      new Chart(document.getElementById('foodChart').getContext('2d'), {
        type: 'pie',
        data: {
          labels: ['Groceries', 'Drinks', 'Dining Out'],
          datasets: [{
            data: [groceries, drinks, dining],
            backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56']
          }]
        },
        options: { 
          responsive: true, 
          plugins: { 
            tooltip: {
              callbacks: {
                label: function(context) {
                  const value = context.raw;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = ((value / total) * 100).toFixed(1);
                  return `${context.label}: ${percentage}% (₹${value})`;
                }
              }
            },
            legend: { position: 'bottom' } 
          } 
        }
      });
    }

    function loadMonthlyData(month) {
      const data = localStorage.getItem(`foodExpenses_${month}`);
      if (data) {
        const expenses = JSON.parse(data);
        document.getElementById('groceries').value = expenses.groceries || '';
        document.getElementById('drinks').value = expenses.drinks || '';
        document.getElementById('dining').value = expenses.dining || '';
        showChart();
      } else {
        document.getElementById('groceries').value = '';
        document.getElementById('drinks').value = '';
        document.getElementById('dining').value = '';
        document.getElementById('summary').innerHTML = '';
        const ctx = document.getElementById('foodChart');
        if (ctx.chart) {
          ctx.chart.destroy();
        }
      }
    }
  </script>
</main>

<footer>
  Beware of little expenses. A small leak will sink a great ship.
</footer>
</body>
</html>
